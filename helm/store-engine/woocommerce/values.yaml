# Store Instance Helm Chart - Default Values for WooCommerce
# Reference: HELM_CHART_DESIGN.md, TECHNICAL_REQUIREMENTS.md

# Store metadata
store:
  # Unique store ID (auto-generated by provisioner)
  id: ""
  # Store name (user-provided)
  name: ""
  # Store engine (woocommerce, medusa)
  engine: woocommerce
  # Creator information
  createdBy: ""
  # Resource plan (basic, standard, premium)
  plan: basic
  # Store description
  description: ""

# Global configuration (injected from parent chart)
global:
  baseDomain: 127.0.0.1.nip.io
  storageClass: standard
  certIssuer: selfsigned

# MySQL Database Configuration
database:
  image:
    repository: mysql
    tag: "8.0"
    pullPolicy: IfNotPresent
  
  # Database credentials (auto-generated if empty)
  rootPassword: ""
  password: ""
  name: wordpress
  user: wordpress
  
  # Persistence
  persistence:
    enabled: true
    size: 5Gi
    accessMode: ReadWriteOnce
    storageClass: ""
  
  # Resources based on plan
  resources:
    basic:
      limits:
        cpu: 500m
        memory: 512Mi
      requests:
        cpu: 100m
        memory: 256Mi
    standard:
      limits:
        cpu: 1000m
        memory: 1Gi
      requests:
        cpu: 250m
        memory: 512Mi
    premium:
      limits:
        cpu: 2000m
        memory: 2Gi
      requests:
        cpu: 500m
        memory: 1Gi
  
  # Health checks
  livenessProbe:
    exec:
      command:
        - mysqladmin
        - ping
    initialDelaySeconds: 30
    periodSeconds: 10
    failureThreshold: 3
  
  readinessProbe:
    exec:
      command:
        - mysqladmin
        - ping
    initialDelaySeconds: 5
    periodSeconds: 5
    failureThreshold: 3

# WordPress / WooCommerce Configuration
wordpress:
  image:
    repository: wordpress
    tag: "6.4-php8.2-apache"
    pullPolicy: IfNotPresent
  
  # Admin credentials (auto-generated if empty)
  admin:
    username: admin
    password: ""
    email: admin@example.com
  
  # WordPress salts (auto-generated)
  salts:
    authKey: ""
    secureAuthKey: ""
    loggedInKey: ""
    nonceKey: ""
    authSalt: ""
    secureAuthSalt: ""
    loggedInSalt: ""
    nonceSalt: ""
  
  # Site configuration
  site:
    title: "My Store"
    url: ""
    language: en_US
  
  # WooCommerce settings
  woocommerce:
    enabled: true
    version: "8.0"
    currency: USD
    country: US
  
  # Resources based on plan
  resources:
    basic:
      limits:
        cpu: 500m
        memory: 512Mi
      requests:
        cpu: 100m
        memory: 256Mi
    standard:
      limits:
        cpu: 1000m
        memory: 1Gi
      requests:
        cpu: 250m
        memory: 512Mi
    premium:
      limits:
        cpu: 2000m
        memory: 2Gi
      requests:
        cpu: 500m
        memory: 1Gi
  
  # Health checks
  livenessProbe:
    httpGet:
      path: /wp-includes/images/blank.gif
      port: http
    initialDelaySeconds: 60
    periodSeconds: 10
    failureThreshold: 3
  
  readinessProbe:
    httpGet:
      path: /wp-includes/images/blank.gif
      port: http
    initialDelaySeconds: 10
    periodSeconds: 5
    failureThreshold: 3
  
  # Uploads persistence
  persistence:
    enabled: true
    size: 5Gi
    accessMode: ReadWriteOnce
    storageClass: ""

# Service configuration
service:
  database:
    type: ClusterIP
    port: 3306
  wordpress:
    type: ClusterIP
    port: 80
    targetPort: 80

# Ingress configuration
ingress:
  enabled: true
  className: nginx
  annotations:
    cert-manager.io/cluster-issuer: "{{ .Values.global.certIssuer }}"
    nginx.ingress.kubernetes.io/proxy-body-size: "100m"
    nginx.ingress.kubernetes.io/proxy-connect-timeout: "600"
    nginx.ingress.kubernetes.io/proxy-send-timeout: "600"
    nginx.ingress.kubernetes.io/proxy-read-timeout: "600"
  tls:
    enabled: true
    secretName: ""

# Network policies for store isolation
networkPolicy:
  enabled: true
  # Allow traffic from monitoring namespace (Prometheus, etc.)
  allowMonitoring: true
  # Allow specific external IPs (for APIs, CDNs, etc.)
  allowExternalIPs: false
  allowedExternalIPs: []
    # - 10.0.0.0/8
    # - 172.16.0.0/12

# Resource quotas
resourceQuota:
  enabled: true
  hard:
    requests.cpu: "2"
    requests.memory: 2Gi
    limits.cpu: "4"
    limits.memory: 4Gi
    persistentvolumeclaims: "2"

# Pod security
podSecurityContext:
  runAsNonRoot: false
  fsGroup: 33

containerSecurityContext:
  allowPrivilegeEscalation: false
  capabilities:
    drop:
      - ALL

# Node selector
nodeSelector: {}

# Tolerations
tolerations: []

# Affinity
affinity: {}
